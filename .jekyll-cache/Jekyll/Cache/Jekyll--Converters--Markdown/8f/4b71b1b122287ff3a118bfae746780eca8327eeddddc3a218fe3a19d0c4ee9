I"[	<p>자바에서 엑셀을 읽는 작업을 할 때</p>

<p>.xls은 HSSF</p>

<p>.xlsx는 XSSF</p>

<p>HSSF / XSSF는 각각의 확장자에게만 적용이 되고 둘다 사용하려면 SXSSF를 사용해야 한다.</p>

<p>하지만 SXSSF는 의존성이 강해서 jar가 많이 필요하다기에 사용하지 않았다.</p>

<p>찾아보니 WorkbookFactory라고 poi에 있는 놈을 이용해서 자동으로 사용 가능하게 할 수 있다더라.</p>

<p>(WorkbookFactory는 poi-ooxml에 존재한다)</p>

<p>최초 항목들 선언도 앞에 HSSF, XSSF 없이 그냥</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="kc">null</span>

<span class="nc">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="kc">null</span>

<span class="nc">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="kc">null</span>

<span class="nc">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="kc">null</span>
</code></pre></div></div>

<p>이렇게만 지정해줘도 사용이 가능하다</p>

<p>받아온 엑셀을 inputstream이나 file에 넣은다음</p>

<p><code class="language-plaintext highlighter-rouge">worbook = WorkbookFactory.create(엑셀파일)</code></p>

<p>이것만 해주면 엑셀 확장자에 맞는 workbook을 반환해준다.</p>

<p>poi 3.9 기준으로 5가지 타입을 받을 수 있다.</p>

<table>
  <thead>
    <tr>
      <th>인풋 타입</th>
      <th>반환타입</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>POIFSFileSystem</td>
      <td>HSSFWorkbook</td>
    </tr>
    <tr>
      <td>NPOIFSFileSystem</td>
      <td>HSSFWorkbook</td>
    </tr>
    <tr>
      <td>OPCPackage</td>
      <td>XSSFWorkbook</td>
    </tr>
    <tr>
      <td>InputStream</td>
      <td>HSSFWorkbook / XSSFWorkbook</td>
    </tr>
    <tr>
      <td>File</td>
      <td>HSSFWorkbook / XSSFWorkbook</td>
    </tr>
  </tbody>
</table>

<p>이후에는 다른 방법들과 똑같이</p>

<p><code class="language-plaintext highlighter-rouge">sheet = workbook.getSheetAt(인덱스)</code>로 sheet를 읽어오고</p>

<p><code class="language-plaintext highlighter-rouge">cell.getStringValue</code>해서 데이터를 읽어오면 된다.</p>

:ET